좋습니다. **35번 – useSessionStorage 세션 스토리지 상태 저장**로 진행하겠습니다.

---

## 35. useSessionStorage 세션 스토리지 상태 저장

### 핵심 개념

* `sessionStorage`는 **브라우저 탭(세션) 단위**로 유지됩니다. 탭을 닫으면 데이터가 사라집니다.
* `localStorage`와 API는 유사하지만 **탭 간 공유되지 않음**이 차이점입니다.

---

### 파일 경로 / 파일명

```
src/hooks/useSessionStorage.js
src/App.js
```

---

### 1) 커스텀 훅 – `useSessionStorage.js`

```javascript
import { useEffect, useState } from 'react';

/**
 * useSessionStorage(key, initialValue)
 * - key: sessionStorage key
 * - initialValue: 기본값(직접 값 or 함수)
 */
export default function useSessionStorage(key, initialValue) {
  const readValue = () => {
    try {
      const raw = window.sessionStorage.getItem(key);
      if (raw === null) {
        return typeof initialValue === 'function' ? initialValue() : initialValue;
      }
      return JSON.parse(raw);
    } catch (e) {
      console.error('sessionStorage 읽기 오류:', e);
      return typeof initialValue === 'function' ? initialValue() : initialValue;
    }
  };

  const [value, setValue] = useState(readValue);

  // 값이 바뀔 때마다 sessionStorage에 반영
  useEffect(() => {
    try {
      window.sessionStorage.setItem(key, JSON.stringify(value));
    } catch (e) {
      console.error('sessionStorage 저장 오류:', e);
    }
  }, [key, value]);

  // 같은 탭 내에서 key가 바뀌는 경우 대비(일반적이지 않지만 안전장치)
  useEffect(() => {
    setValue(readValue());
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [key]);

  // 참고: sessionStorage는 탭 간 공유되지 않으므로 storage 이벤트 동기화는 거의 의미 없음
  return [value, setValue];
}
```

---

### 2) 사용 예제 – `App.js`

```javascript
import React from 'react';
import useSessionStorage from './hooks/useSessionStorage';

export default function App() {
  const [step, setStep] = useSessionStorage('signup-step', 1);
  const [draft, setDraft] = useSessionStorage('signup-draft', {
    email: '',
    nickname: ''
  });

  const next = () => setStep(prev => Math.min(prev + 1, 3));
  const prev = () => setStep(prev => Math.max(prev - 1, 1));

  return (
    <div style={{ padding: 20 }}>
      <h1>useSessionStorage 세션 상태 저장</h1>
      <p>현재 스텝: {step} / 3</p>

      {step === 1 && (
        <div>
          <h2>1. 이메일 입력</h2>
          <input
            value={draft.email}
            onChange={(e) => setDraft({ ...draft, email: e.target.value })}
            placeholder="email@example.com"
          />
        </div>
      )}

      {step === 2 && (
        <div>
          <h2>2. 닉네임 입력</h2>
          <input
            value={draft.nickname}
            onChange={(e) => setDraft({ ...draft, nickname: e.target.value })}
            placeholder="닉네임"
          />
        </div>
      )}

      {step === 3 && (
        <div>
          <h2>3. 확인</h2>
          <pre style={{ background: '#f7f7f7', padding: 12 }}>
{JSON.stringify(draft, null, 2)}
          </pre>
        </div>
      )}

      <div style={{ marginTop: 12, display: 'flex', gap: 8 }}>
        <button onClick={prev} disabled={step === 1}>이전</button>
        <button onClick={next} disabled={step === 3}>다음</button>
        <button onClick={() => { setStep(1); setDraft({ email: '', nickname: '' }); }}>
          초기화
        </button>
      </div>

      <p style={{ marginTop: 8, color: '#666' }}>
        이 값들은 **현재 탭**에서만 유지되며, 탭을 닫으면 사라집니다.
      </p>
    </div>
  );
}
```

---

### 실행 흐름

1. 훅이 마운트되면 `sessionStorage['signup-step']`, `sessionStorage['signup-draft']`를 읽어 초기 상태 설정.
2. 입력/이동 시 상태가 바뀌면 즉시 `sessionStorage`에 JSON으로 저장.
3. 새로고침을 해도 같은 탭에서는 값 유지, 다른 탭에서는 별도 세션으로 독립.
4. 탭을 닫으면 세션이 종료되어 저장된 값은 사라짐.

---

### 사용 사례

* 회원가입/결제 **단계 진행 상황** 임시 저장
* 검색/필터 **임시 값** 유지(해당 탭 내에서만)
* 폼 **초안(draft)** 임시 저장

---

다음은 **36번 – usePrevious 이전 상태 값 저장**으로 넘어가겠습니다. 계속 진행할까요?

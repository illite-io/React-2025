좋습니다. 이제 **21번 – useImperativeHandle 자식 메서드 노출** 예제를 보겠습니다.

---

## 21. useImperativeHandle 자식 메서드 노출

### 목표

* 부모가 자식의 특정 메서드를 직접 호출할 수 있도록 **ref와 useImperativeHandle** 사용
* 보통 **커스텀 입력 컴포넌트**, **컨트롤 가능한 UI 컴포넌트**에서 유용

---

### 파일 경로 / 파일명

```
src/App.js
```

### 예시 코드

```javascript
import React, { forwardRef, useImperativeHandle, useRef, useState } from 'react';

// 자식 컴포넌트
const CustomInput = forwardRef((props, ref) => {
  const inputRef = useRef();
  const [value, setValue] = useState("");

  // 부모에게 노출할 메서드 정의
  useImperativeHandle(ref, () => ({
    focus: () => {
      inputRef.current.focus();
    },
    clear: () => {
      setValue("");
      inputRef.current.focus();
    },
    getValue: () => value
  }));

  return (
    <input
      ref={inputRef}
      value={value}
      onChange={(e) => setValue(e.target.value)}
      placeholder="커스텀 입력창"
      style={{ padding: "8px", fontSize: "16px" }}
    />
  );
});

export default function App() {
  const customInputRef = useRef();

  const handleFocus = () => {
    customInputRef.current.focus();
  };

  const handleClear = () => {
    customInputRef.current.clear();
  };

  const handleGetValue = () => {
    alert("현재 값: " + customInputRef.current.getValue());
  };

  return (
    <div style={{ padding: 20 }}>
      <h1>useImperativeHandle 예제</h1>
      <CustomInput ref={customInputRef} />

      <div style={{ marginTop: 12 }}>
        <button onClick={handleFocus}>포커스</button>
        <button onClick={handleClear}>초기화</button>
        <button onClick={handleGetValue}>값 확인</button>
      </div>
    </div>
  );
}
```

---

### 코드 설명

1. **forwardRef**

   ```javascript
   const CustomInput = forwardRef((props, ref) => { ... });
   ```

   * ref를 자식 컴포넌트로 전달 가능하게 만듦

2. **useImperativeHandle**

   ```javascript
   useImperativeHandle(ref, () => ({
     focus: () => { ... },
     clear: () => { ... },
     getValue: () => value
   }));
   ```

   * 부모가 사용할 수 있는 메서드 목록을 정의
   * 실제 내부 구현은 숨기고 필요한 기능만 노출

3. **부모에서 사용**

   ```javascript
   customInputRef.current.focus();
   customInputRef.current.clear();
   customInputRef.current.getValue();
   ```

   * 마치 DOM 요소의 메서드처럼 자식의 커스텀 메서드 호출 가능

---

### 실행 흐름

1. `App`에서 `<CustomInput ref={customInputRef} />` 렌더링
2. 버튼 클릭 시 `customInputRef.current`의 메서드 호출
3. * 포커스 버튼 → input에 포커스
   * 초기화 버튼 → 값 비우고 포커스
   * 값 확인 버튼 → 현재 입력값 alert

---

다음은 **22번 – useLayoutEffect DOM 변경 직후 실행** 예제로 넘어가겠습니다. 계속 진행할까요?

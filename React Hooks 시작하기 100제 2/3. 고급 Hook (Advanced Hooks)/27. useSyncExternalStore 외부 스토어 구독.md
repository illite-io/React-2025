ì¢‹ìŠµë‹ˆë‹¤. ì´ì œ **27ë²ˆ â€“ useSyncExternalStore ì™¸ë¶€ ìŠ¤í† ì–´ êµ¬ë…** ì˜ˆì œë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.

---

## 27. useSyncExternalStore ì™¸ë¶€ ìŠ¤í† ì–´ êµ¬ë…

### í•µì‹¬ ê°œë…

* React 18ì—ì„œ ì¶”ê°€ëœ Hook
* **ì™¸ë¶€ ìŠ¤í† ì–´(state container)** ë¥¼ Reactì™€ ë™ê¸°í™”í•˜ëŠ” í‘œì¤€ API
* ì˜ˆì „ì—ëŠ” `useEffect` + ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¡°í•©ìœ¼ë¡œ ì§ì ‘ êµ¬ë…í–ˆì§€ë§Œ,
  `useSyncExternalStore`ëŠ” **SSR ì§€ì› + ì•ˆì •ì ì¸ ë™ê¸°í™”**ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
* Redux, Zustand ê°™ì€ ìƒíƒœê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë‚´ë¶€ì—ì„œë„ ì´ APIë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

---

### íŒŒì¼ ê²½ë¡œ / íŒŒì¼ëª…

```
src/store/counterStore.js
```

### ê°„ë‹¨í•œ ì¹´ìš´í„° ìŠ¤í† ì–´ êµ¬í˜„

```javascript
let count = 0;
const listeners = new Set();

export const counterStore = {
  // ìƒíƒœ ì½ê¸°
  getSnapshot: () => count,

  // ìƒíƒœ ì—…ë°ì´íŠ¸
  increment: () => {
    count++;
    listeners.forEach((listener) => listener());
  },
  decrement: () => {
    count--;
    listeners.forEach((listener) => listener());
  },

  // êµ¬ë… ê´€ë¦¬
  subscribe: (listener) => {
    listeners.add(listener);
    return () => listeners.delete(listener); // êµ¬ë… í•´ì œ
  },
};
```

---

### íŒŒì¼ ê²½ë¡œ / íŒŒì¼ëª…

```
src/App.js
```

### React ì»´í¬ë„ŒíŠ¸ì—ì„œ êµ¬ë…í•˜ê¸°

```javascript
import React, { useSyncExternalStore } from 'react';
import { counterStore } from './store/counterStore';

export default function App() {
  // ì™¸ë¶€ ìŠ¤í† ì–´ì™€ ë™ê¸°í™”
  const count = useSyncExternalStore(
    counterStore.subscribe,   // êµ¬ë… í•¨ìˆ˜
    counterStore.getSnapshot  // í˜„ì¬ ìƒíƒœ ê°€ì ¸ì˜¤ê¸°
  );

  return (
    <div style={{ padding: 20 }}>
      <h1>useSyncExternalStore ì˜ˆì œ</h1>
      <p>í˜„ì¬ ì¹´ìš´íŠ¸: {count}</p>
      <button onClick={counterStore.increment}>+1</button>
      <button onClick={counterStore.decrement}>-1</button>
    </div>
  );
}
```

---

### ì½”ë“œ ì„¤ëª…

1. **ìŠ¤í† ì–´ êµ¬ì¡°**

   * `count`ëŠ” React stateê°€ ì•„ë‹˜ (ì™¸ë¶€ ë³€ìˆ˜)
   * `listeners`ì— ì»´í¬ë„ŒíŠ¸ êµ¬ë…ì ë“±ë¡
   * ìƒíƒœê°€ ë°”ë€Œë©´ `listeners` ì „ë¶€ í˜¸ì¶œ â†’ ë¦¬ë Œë”ë§ ìœ ë„

2. **useSyncExternalStore**

   ```javascript
   const value = useSyncExternalStore(subscribe, getSnapshot);
   ```

   * `subscribe(listener)` : ìƒíƒœê°€ ë°”ë€Œë©´ listener ì‹¤í–‰ â†’ Reactê°€ ìë™ ë¦¬ë Œë”ë§
   * `getSnapshot()` : í˜„ì¬ ìƒíƒœ ë°˜í™˜ (ë Œë”ë§ ì‹œ ë™ê¸°ì ìœ¼ë¡œ ê°’ ì œê³µ)

3. **ì¥ì **

   * SSR í™˜ê²½ì—ì„œ ì´ˆê¸° ìŠ¤ëƒ…ìƒ· ë™ê¸°í™” ê°€ëŠ¥
   * ì™¸ë¶€ ìŠ¤í† ì–´ë¥¼ React stateì²˜ëŸ¼ ì•ˆì „í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥
   * Redux, Zustand ë“± ë¼ì´ë¸ŒëŸ¬ë¦¬ êµ¬í˜„ì˜ ê¸°ë°˜

---

### ì‹¤í–‰ íë¦„

1. `App` ë Œë”ë§ â†’ `useSyncExternalStore`ë¡œ count ê°’ ì½ìŒ (ì´ˆê¸°ê°’ 0)
2. ë²„íŠ¼ í´ë¦­ â†’ `counterStore.increment()` ì‹¤í–‰ â†’ count ì¦ê°€ í›„ ëª¨ë“  êµ¬ë…ì listener í˜¸ì¶œ
3. `useSyncExternalStore`ê°€ listenerë¥¼ í†µí•´ ìƒíƒœ ë³€ê²½ ê°ì§€ â†’ ì»´í¬ë„ŒíŠ¸ ë¦¬ë Œë”ë§

---

ğŸ‘‰ ì—¬ê¸°ê¹Œì§€ í•˜ë©´, React stateê°€ ì•„ë‹Œ ì™¸ë¶€ ìŠ¤í† ì–´ ê°’ë„ ì•ˆì •ì ìœ¼ë¡œ React ë Œë”ë§ ì‚¬ì´í´ì— ë§ì¶° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

ë‹¤ìŒì€ **28ë²ˆ â€“ useInsertionEffect ìŠ¤íƒ€ì¼ ì‚½ì… íƒ€ì´ë° ì œì–´** ì˜ˆì œë¡œ ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤. ê³„ì† ì§„í–‰í• ê¹Œìš”?

좋습니다. 이번에는 **94번 – useIntersectionObserver 요소 노출 감지** 예제를 보겠습니다.

---

## 94. useIntersectionObserver 요소 노출 감지

### 목표

* 브라우저 **IntersectionObserver API** 활용
* 특정 DOM 요소가 뷰포트에 보이는지 감지
* 스크롤 애니메이션, 이미지 지연 로딩, 무한 스크롤 등에 활용

---

### 파일 경로 / 파일명

```
src/hooks/useIntersectionObserver.js
src/App.js
```

---

### 1) 커스텀 훅 – `useIntersectionObserver.js`

```javascript
import { useEffect, useRef, useState } from "react";

/**
 * useIntersectionObserver({ root, rootMargin, threshold })
 * 반환: { ref, entry, isIntersecting }
 * - ref: 관찰할 DOM 요소에 붙임
 * - entry: IntersectionObserverEntry
 * - isIntersecting: 뷰포트 안에 보이는지 여부
 */
export default function useIntersectionObserver(options = {}) {
  const { root = null, rootMargin = "0px", threshold = 0 } = options;

  const ref = useRef(null);
  const [entry, setEntry] = useState(null);

  useEffect(() => {
    if (!ref.current) return;

    const observer = new IntersectionObserver(
      (entries) => {
        setEntry(entries[0]);
      },
      { root, rootMargin, threshold }
    );

    observer.observe(ref.current);

    return () => {
      observer.disconnect();
    };
  }, [root, rootMargin, threshold]);

  return { ref, entry, isIntersecting: entry?.isIntersecting ?? false };
}
```

---

### 2) 사용 예제 – `App.js`

```javascript
import React from "react";
import useIntersectionObserver from "./hooks/useIntersectionObserver";

function Box({ i }) {
  const { ref, isIntersecting } = useIntersectionObserver({ threshold: 0.5 });

  return (
    <div
      ref={ref}
      style={{
        height: 200,
        margin: "20px 0",
        background: isIntersecting ? "#4ade80" : "#fca5a5",
        display: "flex",
        alignItems: "center",
        justifyContent: "center",
        fontSize: 20,
        fontWeight: "bold",
        borderRadius: 8,
        transition: "background 0.3s",
      }}
    >
      {isIntersecting ? `Box ${i} 보임` : `Box ${i} 숨김`}
    </div>
  );
}

export default function App() {
  return (
    <div style={{ padding: 20 }}>
      <h1>useIntersectionObserver 요소 노출 감지</h1>
      <p>아래 박스들이 뷰포트에 50% 이상 들어오면 색상이 바뀝니다.</p>
      <div style={{ height: 600, overflowY: "scroll", border: "1px solid #e5e7eb" }}>
        {Array.from({ length: 10 }, (_, i) => (
          <Box key={i} i={i + 1} />
        ))}
      </div>
    </div>
  );
}
```

---

### 동작 방식

1. `ref`를 특정 DOM 요소에 연결
2. 브라우저 `IntersectionObserver`가 요소의 가시성 상태를 감지
3. `isIntersecting` 값이 true일 때 → 뷰포트 안에 요소가 일정 비율 이상 들어옴

---

### 활용 아이디어

* **Lazy Loading**: 이미지가 화면에 들어올 때만 로드
* **스크롤 애니메이션**: 요소가 보일 때 fade-in 효과
* **무한 스크롤**: 마지막 아이템이 보일 때 추가 데이터 로드

---

다음은 **95번 – useInfiniteScroll 무한 스크롤** 예제로 넘어가시겠습니까?

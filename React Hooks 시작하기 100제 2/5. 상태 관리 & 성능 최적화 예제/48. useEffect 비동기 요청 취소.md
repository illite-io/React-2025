좋습니다. 이제 **48번 – useEffect 비동기 요청 취소** 예제를 보겠습니다.

---

## 48. useEffect 비동기 요청 취소

### 핵심 개념

* `useEffect` 안에서 fetch 같은 비동기 요청을 보낼 때,
  컴포넌트가 언마운트되거나 의존성이 바뀌면 **이전 요청을 취소**해야 합니다.
* 그렇지 않으면 **경쟁 상태(race condition)** 문제로 오래된 응답이 나중에 덮어쓸 수 있음.
* `AbortController`를 활용하면 fetch 요청을 안전하게 취소할 수 있습니다.

---

### 파일 경로 / 파일명

```
src/App.js
```

---

### 코드 예제 – 비동기 요청 취소

```javascript
import React, { useEffect, useState } from "react";

export default function App() {
  const [query, setQuery] = useState("react");
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(false);

  useEffect(() => {
    const controller = new AbortController(); // 요청 취소 컨트롤러
    const signal = controller.signal;

    const fetchData = async () => {
      setLoading(true);
      try {
        const res = await fetch(
          `https://hn.algolia.com/api/v1/search?query=${query}`,
          { signal }
        );
        const json = await res.json();
        setData(json.hits);
      } catch (err) {
        if (err.name === "AbortError") {
          console.log("요청 취소됨:", query);
        } else {
          console.error("에러 발생:", err);
        }
      } finally {
        setLoading(false);
      }
    };

    fetchData();

    // cleanup 함수 → 언마운트되거나 query 변경 시 실행
    return () => {
      controller.abort(); // 요청 취소
    };
  }, [query]);

  return (
    <div style={{ padding: 20 }}>
      <h1>useEffect 비동기 요청 취소</h1>
      <input
        type="text"
        value={query}
        onChange={(e) => setQuery(e.target.value)}
        placeholder="검색어 입력"
      />
      {loading && <p>불러오는 중...</p>}
      <ul>
        {data?.map((item) => (
          <li key={item.objectID}>{item.title}</li>
        ))}
      </ul>
    </div>
  );
}
```

---

### 실행 흐름

1. 사용자가 검색어를 입력할 때마다 `query` 변경 → `useEffect` 실행
2. 새로운 fetch 실행, 이전 fetch는 `controller.abort()`로 취소
3. 오래된 요청 응답이 도착해도 무시되므로 데이터 덮어쓰기 방지

---

### 활용 아이디어

* **검색창 자동완성**: 입력이 바뀔 때마다 요청, 이전 요청은 취소
* **탭 전환 UI**: 다른 탭으로 이동 시 현재 탭의 네트워크 요청 중단
* **리스트 스크롤 페이징**: 사용자가 스크롤을 빠르게 내릴 때 불필요한 요청 취소

---

👉 다음은 **49번 – useRef 캐러셀 구현** 예제로 넘어가겠습니다. 계속 진행할까요?

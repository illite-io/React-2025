# âœ… 081. ë¡œê·¸ì¸ ì‹¤íŒ¨ íšŸìˆ˜ ì œí•œ ë° ê³„ì • ì ê¸ˆ ì²˜ë¦¬

### ğŸ“„ ì„¤ëª…

ë³´ì•ˆì„ ê°•í™”í•˜ê¸° ìœ„í•´ **ë¡œê·¸ì¸ ì‹¤íŒ¨ íšŸìˆ˜ë¥¼ ì œí•œ**í•˜ê³ ,
ì§€ì •ëœ íšŸìˆ˜ ì´ˆê³¼ ì‹œ **ì¼ì‹œì ìœ¼ë¡œ ê³„ì •ì„ ì ê·¸ëŠ” ê¸°ëŠ¥**ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

---

## âœ… ì£¼ìš” í¬ì¸íŠ¸

* ì‚¬ìš©ì ëª¨ë¸ì— `loginFailCount`, `lockUntil` í•„ë“œ ì¶”ê°€
* ë¡œê·¸ì¸ ì‹œ ì‹¤íŒ¨ íšŸìˆ˜ ì¦ê°€ ë° ì‹œê°„ ê¸°ë°˜ ì ê¸ˆ ì²˜ë¦¬
* ì ê¸ˆëœ ê³„ì •ì€ ë¡œê·¸ì¸ ì°¨ë‹¨ ë° ì•ˆë‚´ ë©”ì‹œì§€ ì¶œë ¥

---

### ğŸ“ ì˜ˆì‹œ ì½”ë“œ

#### 1. ì‚¬ìš©ì ëª¨ë¸ (Mongoose ê¸°ì¤€)

```js
loginFailCount: {
  type: Number,
  default: 0,
},
lockUntil: {
  type: Date,
  default: null,
}
```

---

#### 2. ë¡œê·¸ì¸ ë¡œì§ (Node.js ì˜ˆì‹œ)

```js
const MAX_FAILS = 5;
const LOCK_TIME = 1000 * 60 * 10; // 10ë¶„

if (user.lockUntil && user.lockUntil > Date.now()) {
  return res.status(403).json({ message: 'ê³„ì •ì´ ì ê¸ˆ ìƒíƒœì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.' });
}

// ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ ì‹¤íŒ¨
if (!isPasswordCorrect) {
  user.loginFailCount += 1;

  if (user.loginFailCount >= MAX_FAILS) {
    user.lockUntil = new Date(Date.now() + LOCK_TIME);
    user.loginFailCount = 0;
  }

  await user.save();
  return res.status(401).json({ message: 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.' });
}

// ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ì´ˆê¸°í™”
user.loginFailCount = 0;
user.lockUntil = null;
await user.save();
```

---

### ğŸ“ ì¶”ê°€ ì„¤ëª…

* `loginFailCount`ëŠ” ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜ ì‹œì—ë§Œ ì¦ê°€
* `lockUntil`ì„ ë¹„êµí•˜ì—¬ ì¼ì • ì‹œê°„ ë™ì•ˆ ë¡œê·¸ì¸ ë¶ˆê°€ ì²˜ë¦¬
* í”„ë¡ íŠ¸ì—ì„œëŠ” ì ê¸ˆ ìƒíƒœ ë©”ì‹œì§€ë¥¼ ë°›ì•„ ì‚¬ìš©ìì—ê²Œ ì•ˆë‚´

---

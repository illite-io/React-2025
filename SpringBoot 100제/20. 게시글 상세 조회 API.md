### 20. API 응답 포맷 표준화 (성공/실패 응답)

---

#### 1) **왜 응답 포맷을 표준화해야 하나?**

* API 응답이 **일관되지 않으면** 클라이언트(React, 모바일 앱)에서 처리하기 어렵다.
* 성공/실패 여부, 응답 데이터, 에러 메시지를 **일관된 형식**으로 제공하면 유지보수성이 높아짐.

---

#### 2) **표준 응답 구조 예시**

```json
{
  "success": true,
  "data": {
    "id": 1,
    "name": "홍길동"
  },
  "error": null
}
```

실패 예시:

```json
{
  "success": false,
  "data": null,
  "error": {
    "code": "USER_NOT_FOUND",
    "message": "사용자를 찾을 수 없습니다."
  }
}
```

---

#### 3) **Response DTO 생성**

**경로**: `src/main/java/com/example/springbootstart/dto/ApiResponse.java`

```java
package com.example.springbootstart.dto;

public class ApiResponse<T> {
    private boolean success;
    private T data;
    private ErrorResponse error;

    public ApiResponse(boolean success, T data, ErrorResponse error) {
        this.success = success;
        this.data = data;
        this.error = error;
    }

    // 성공 응답
    public static <T> ApiResponse<T> success(T data) {
        return new ApiResponse<>(true, data, null);
    }

    // 실패 응답
    public static <T> ApiResponse<T> error(String code, String message) {
        return new ApiResponse<>(false, null, new ErrorResponse(code, message));
    }

    // 내부 클래스: 오류 정보
    public static class ErrorResponse {
        private String code;
        private String message;

        public ErrorResponse(String code, String message) {
            this.code = code;
            this.message = message;
        }
        public String getCode() { return code; }
        public String getMessage() { return message; }
    }

    public boolean isSuccess() { return success; }
    public T getData() { return data; }
    public ErrorResponse getError() { return error; }
}
```

---

#### 4) **Controller 예시**

**경로**: `src/main/java/com/example/springbootstart/controller/ApiResponseController.java`

```java
package com.example.springbootstart.controller;

import com.example.springbootstart.dto.ApiResponse;
import com.example.springbootstart.dto.UserDto;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/response")
public class ApiResponseController {

    @GetMapping("/user/{id}")
    public ApiResponse<?> getUser(@PathVariable Long id) {
        if (id == 1L) {
            UserDto user = new UserDto();
            user.setName("홍길동");
            user.setAge(30);
            return ApiResponse.success(user);
        } else {
            return ApiResponse.error("USER_NOT_FOUND", "사용자를 찾을 수 없습니다.");
        }
    }
}
```

---

#### 5) **실행 확인**

* `http://localhost:8080/api/response/user/1`

```json
{
  "success": true,
  "data": {
    "name": "홍길동",
    "age": 30
  },
  "error": null
}
```

* `http://localhost:8080/api/response/user/2`

```json
{
  "success": false,
  "data": null,
  "error": {
    "code": "USER_NOT_FOUND",
    "message": "사용자를 찾을 수 없습니다."
  }
}
```

---

#### 6) **장점**

* 모든 API가 동일한 응답 구조 → **프론트엔드 처리 용이**
* 에러 발생 시 **에러 코드**를 명확하게 제공 가능

---

**다음 단계는 `21. MySQL 설치 및 연결 테스트` 입니다. 진행할까요?**

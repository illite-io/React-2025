### 26. Mapper 인터페이스와 XML 연동

---

#### 1) **연동 개념**

* MyBatis는 **Java Mapper 인터페이스**와 **XML Mapper 파일**을 **namespace**로 연결하여 작동
* Mapper 인터페이스 메서드 이름 = XML 내 SQL id → 자동 매핑

---

#### 2) **UserMapper Interface**

(이전 단계에서 작성한 파일)
**경로**: `src/main/java/com/example/springbootstart/mapper/UserMapper.java`

```java
package com.example.springbootstart.mapper;

import com.example.springbootstart.dto.UserDto;
import org.apache.ibatis.annotations.Mapper;
import java.util.List;

@Mapper
public interface UserMapper {
    List<UserDto> findAll();     // 전체 조회
    UserDto findById(Long id);   // 단일 조회
    int insertUser(UserDto user);// 등록
    int updateUser(UserDto user);// 수정
    int deleteUser(Long id);     // 삭제
}
```

---

#### 3) **UserMapper XML**

(이전 단계에서 작성한 파일)
**경로**: `src/main/resources/mapper/UserMapper.xml`

```xml
<mapper namespace="com.example.springbootstart.mapper.UserMapper">

    <resultMap id="userMap" type="com.example.springbootstart.dto.UserDto">
        <id property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="age" column="age"/>
        <result property="email" column="email"/>
    </resultMap>

    <select id="findAll" resultMap="userMap">
        SELECT * FROM user
    </select>

    <select id="findById" parameterType="long" resultMap="userMap">
        SELECT * FROM user WHERE id = #{id}
    </select>

    <insert id="insertUser" parameterType="com.example.springbootstart.dto.UserDto">
        INSERT INTO user (name, age, email)
        VALUES (#{name}, #{age}, #{email})
    </insert>

    <update id="updateUser" parameterType="com.example.springbootstart.dto.UserDto">
        UPDATE user SET
            name = #{name},
            age = #{age},
            email = #{email}
        WHERE id = #{id}
    </update>

    <delete id="deleteUser" parameterType="long">
        DELETE FROM user WHERE id = #{id}
    </delete>
</mapper>
```

---

#### 4) **설정 확인 (application.yml)**

```yaml
mybatis:
  mapper-locations: classpath:mapper/**/*.xml
  type-aliases-package: com.example.springbootstart.dto
```

* `mapper-locations` → Mapper XML 경로
* `type-aliases-package` → DTO 패키지 경로

---

#### 5) **연동 테스트 Controller**

**경로**: `src/main/java/com/example/springbootstart/controller/UserMapperTestController.java`

```java
package com.example.springbootstart.controller;

import com.example.springbootstart.dto.UserDto;
import com.example.springbootstart.mapper.UserMapper;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/mapper-test")
public class UserMapperTestController {

    private final UserMapper userMapper;

    public UserMapperTestController(UserMapper userMapper) {
        this.userMapper = userMapper;
    }

    @GetMapping("/all")
    public List<UserDto> getAllUsers() {
        return userMapper.findAll();
    }

    @GetMapping("/{id}")
    public UserDto getUserById(@PathVariable Long id) {
        return userMapper.findById(id);
    }
}
```

---

#### 6) **실행 결과**

* `http://localhost:8080/mapper-test/all` → 모든 사용자 JSON 반환
* `http://localhost:8080/mapper-test/1` → 특정 사용자 JSON 반환

---

**다음 단계는 `27. 샘플 테이블 생성 (회원 테이블)` 입니다. 진행할까요?**

### 38. ResponseEntity 활용 응답 처리

---

#### 1) **목표**

* 컨트롤러 응답 시 **HTTP 상태 코드 + 응답 데이터**를 명확하게 전달
* 기존 `String` 반환 대신 **ResponseEntity**로 표준화

---

#### 2) **ResponseEntity란?**

* HTTP 응답 전체(상태 코드, 헤더, 바디)를 제어 가능
* 다양한 상태 코드 반환 가능:

  * `200 OK` → 정상 응답
  * `201 CREATED` → 생성 성공
  * `400 BAD REQUEST` → 잘못된 요청
  * `404 NOT FOUND` → 데이터 없음
  * `500 INTERNAL SERVER ERROR` → 서버 오류

---

#### 3) **회원 등록 API 수정**

**파일 경로**: `src/main/java/com/example/springbootstart/controller/UserController.java`

```java
@PostMapping
public ResponseEntity<?> createUser(@Valid @RequestBody UserDto userDto) {
    int result = userService.createUser(userDto);
    if (result == 1) {
        return ResponseEntity.status(HttpStatus.CREATED)
                .body(Map.of("message", "회원 등록 성공"));
    } else {
        return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
                .body(Map.of("message", "회원 등록 실패"));
    }
}
```

---

#### 4) **회원 조회 API 수정**

```java
@GetMapping("/{id}")
public ResponseEntity<?> getUser(@PathVariable Long id) {
    UserDto user = userService.getUser(id);
    if (user != null) {
        return ResponseEntity.ok(user); // 200 OK
    } else {
        return ResponseEntity.status(HttpStatus.NOT_FOUND)
                .body(Map.of("message", "회원이 존재하지 않습니다."));
    }
}
```

---

#### 5) **회원 삭제 API 수정**

```java
@DeleteMapping("/{id}")
public ResponseEntity<?> deleteUser(@PathVariable Long id) {
    int result = userService.deleteUser(id);
    if (result == 1) {
        return ResponseEntity.ok(Map.of("message", "회원 삭제 성공"));
    } else {
        return ResponseEntity.status(HttpStatus.NOT_FOUND)
                .body(Map.of("message", "회원이 존재하지 않습니다."));
    }
}
```

---

#### 6) **테스트**

1. **POST 요청** → 응답 코드: 201
2. **없는 회원 조회(GET)** → 응답 코드: 404
3. **없는 회원 삭제(DELETE)** → 응답 코드: 404

---

#### 7) **장점**

* API 응답이 **HTTP 표준 상태 코드** 기반 → 클라이언트 처리 용이
* 응답 구조를 일관되게 유지 가능

---

**다음 단계는 `39. Service 계층 트랜잭션 적용` 입니다. 진행할까요?**

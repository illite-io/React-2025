### 57. 사용자 프로필 + 작성 게시글 목록 반환

---

#### 1) **목표**

* 사용자 프로필(이름, 이메일, 나이)과 함께 사용자가 작성한 게시글 목록 반환
* 하나의 API에서 두 가지 정보 동시에 제공

---

#### 2) **DTO 작성**

**경로**: `src/main/java/com/example/springbootstart/dto/UserProfileDto.java`

```java
package com.example.springbootstart.dto;

import lombok.Getter;
import lombok.Setter;

import java.util.List;

@Getter
@Setter
public class UserProfileDto {
    private Long id;
    private String name;
    private int age;
    private String email;

    private List<BoardDto> boards;  // 작성한 게시글 목록
}
```

---

#### 3) **Mapper 인터페이스**

**경로**: `src/main/java/com/example/springbootstart/mapper/UserMapper.java`

```java
package com.example.springbootstart.mapper;

import com.example.springbootstart.dto.UserDto;
import com.example.springbootstart.dto.BoardDto;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;

import java.util.List;

@Mapper
public interface UserMapper {
    UserDto findUserById(@Param("id") Long id);
    List<BoardDto> findBoardsByUserId(@Param("userId") Long userId);
}
```

---

#### 4) **Mapper XML**

**경로**: `src/main/resources/mapper/UserMapper.xml`

```xml
<mapper namespace="com.example.springbootstart.mapper.UserMapper">

    <select id="findUserById" parameterType="long" resultType="com.example.springbootstart.dto.UserDto">
        SELECT id, name, age, email, created_at AS createdAt, updated_at AS updatedAt
        FROM user
        WHERE id = #{id}
    </select>

    <select id="findBoardsByUserId" parameterType="long" resultType="com.example.springbootstart.dto.BoardDto">
        SELECT id, user_id AS userId, title, content, created_at AS createdAt, updated_at AS updatedAt
        FROM board
        WHERE user_id = #{userId}
        ORDER BY id DESC
    </select>
</mapper>
```

---

#### 5) **Service**

**경로**: `src/main/java/com/example/springbootstart/service/UserService.java`

```java
package com.example.springbootstart.service;

import com.example.springbootstart.dto.UserDto;
import com.example.springbootstart.dto.BoardDto;
import com.example.springbootstart.dto.UserProfileDto;
import com.example.springbootstart.mapper.UserMapper;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class UserService {

    private final UserMapper userMapper;
    public UserService(UserMapper userMapper) {
        this.userMapper = userMapper;
    }

    public UserProfileDto getUserProfile(Long id) {
        UserDto user = userMapper.findUserById(id);
        if (user == null) return null;

        List<BoardDto> boards = userMapper.findBoardsByUserId(id);

        UserProfileDto profile = new UserProfileDto();
        profile.setId(user.getId());
        profile.setName(user.getName());
        profile.setAge(user.getAge());
        profile.setEmail(user.getEmail());
        profile.setBoards(boards);

        return profile;
    }
}
```

---

#### 6) **Controller**

**경로**: `src/main/java/com/example/springbootstart/controller/UserController.java`

```java
@GetMapping("/profile/{id}")
public ResponseEntity<?> getUserProfile(@PathVariable Long id) {
    var profile = userService.getUserProfile(id);
    return profile != null ? ResponseEntity.ok(profile)
                           : ResponseEntity.notFound().build();
}
```

---

#### 7) **테스트 요청**

**GET 요청**

```
http://localhost:8080/users/profile/1
```

**응답(JSON 예시)**

```json
{
  "id": 1,
  "name": "홍길동",
  "age": 30,
  "email": "hong@test.com",
  "boards": [
    {
      "id": 5,
      "userId": 1,
      "title": "추가 작성한 게시글",
      "content": "내용",
      "createdAt": "2025-08-03T12:30:00",
      "updatedAt": "2025-08-03T12:30:00"
    },
    {
      "id": 1,
      "userId": 1,
      "title": "첫 번째 게시글",
      "content": "안녕하세요, 첫 번째 게시글입니다.",
      "createdAt": "2025-08-03T12:00:00",
      "updatedAt": "2025-08-03T12:00:00"
    }
  ]
}
```

---

#### 8) **결과**

* 사용자 프로필 + 작성한 게시글이 함께 반환됨
* 한 번의 API 호출로 필요한 데이터 모두 제공

---

**다음 단계는 `58. 회원 가입 시 중복 이메일 체크` 입니다. 진행할까요?**

### 44. 게시글 수정 API

---

#### 1) **목표**

* 게시글 `id`를 기준으로 제목·내용 수정
* 수정 후 성공/실패 여부 응답

---

#### 2) **Mapper 인터페이스 수정**

**경로**: `src/main/java/com/example/springbootstart/mapper/BoardMapper.java`

```java
package com.example.springbootstart.mapper;

import com.example.springbootstart.dto.BoardDto;
import org.apache.ibatis.annotations.Mapper;
import java.util.List;

@Mapper
public interface BoardMapper {
    int insertBoard(BoardDto board);
    List<BoardDto> findAllBoards();
    BoardDto findBoardById(Long id);

    // 게시글 수정
    int updateBoard(BoardDto board);
}
```

---

#### 3) **Mapper XML 수정**

**경로**: `src/main/resources/mapper/BoardMapper.xml`

```xml
<mapper namespace="com.example.springbootstart.mapper.BoardMapper">

    <insert id="insertBoard" parameterType="com.example.springbootstart.dto.BoardDto">
        INSERT INTO board (user_id, title, content)
        VALUES (#{userId}, #{title}, #{content})
    </insert>

    <select id="findAllBoards" resultType="com.example.springbootstart.dto.BoardDto">
        SELECT id, user_id AS userId, title, content, created_at AS createdAt, updated_at AS updatedAt
        FROM board
        ORDER BY id DESC
    </select>

    <select id="findBoardById" parameterType="long" resultType="com.example.springbootstart.dto.BoardDto">
        SELECT id, user_id AS userId, title, content, created_at AS createdAt, updated_at AS updatedAt
        FROM board
        WHERE id = #{id}
    </select>

    <!-- 게시글 수정 -->
    <update id="updateBoard" parameterType="com.example.springbootstart.dto.BoardDto">
        UPDATE board
        SET title = #{title},
            content = #{content}
        WHERE id = #{id}
    </update>
</mapper>
```

---

#### 4) **Service 수정**

**경로**: `src/main/java/com/example/springbootstart/service/BoardService.java`

```java
package com.example.springbootstart.service;

import com.example.springbootstart.dto.BoardDto;
import com.example.springbootstart.mapper.BoardMapper;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import java.util.List;

@Service
public class BoardService {
    private final BoardMapper boardMapper;

    public BoardService(BoardMapper boardMapper) {
        this.boardMapper = boardMapper;
    }

    public int createBoard(BoardDto boardDto) {
        return boardMapper.insertBoard(boardDto);
    }

    public List<BoardDto> getAllBoards() {
        return boardMapper.findAllBoards();
    }

    public BoardDto getBoard(Long id) {
        return boardMapper.findBoardById(id);
    }

    @Transactional
    public int updateBoard(BoardDto boardDto) {
        return boardMapper.updateBoard(boardDto);
    }
}
```

---

#### 5) **Controller 수정**

**경로**: `src/main/java/com/example/springbootstart/controller/BoardController.java`

```java
package com.example.springbootstart.controller;

import com.example.springbootstart.dto.BoardDto;
import com.example.springbootstart.service.BoardService;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/boards")
public class BoardController {

    private final BoardService boardService;
    public BoardController(BoardService boardService) {
        this.boardService = boardService;
    }

    @PostMapping
    public ResponseEntity<?> createBoard(@RequestBody BoardDto boardDto) {
        int result = boardService.createBoard(boardDto);
        return result == 1 ? ResponseEntity.ok("게시글 등록 성공")
                           : ResponseEntity.badRequest().body("게시글 등록 실패");
    }

    @GetMapping
    public List<BoardDto> getAllBoards() {
        return boardService.getAllBoards();
    }

    @GetMapping("/{id}")
    public ResponseEntity<?> getBoard(@PathVariable Long id) {
        BoardDto board = boardService.getBoard(id);
        return board != null ? ResponseEntity.ok(board)
                             : ResponseEntity.notFound().build();
    }

    // 게시글 수정 API
    @PutMapping("/{id}")
    public ResponseEntity<?> updateBoard(@PathVariable Long id, @RequestBody BoardDto boardDto) {
        boardDto.setId(id);
        int result = boardService.updateBoard(boardDto);
        return result == 1 ? ResponseEntity.ok("게시글 수정 성공")
                           : ResponseEntity.badRequest().body("게시글 수정 실패");
    }
}
```

---

#### 6) **테스트 요청**

**PUT 요청**

```
http://localhost:8080/boards/1
```

**Body(JSON)**:

```json
{
  "title": "수정된 게시글 제목",
  "content": "수정된 게시글 내용입니다."
}
```

**응답**

```
게시글 수정 성공
```

---

#### 7) **DB 확인**

```sql
SELECT * FROM board WHERE id = 1;
```

* 제목과 내용이 수정되어 있어야 함

---

**다음 단계는 `45. 게시글 삭제 API` 입니다. 진행할까요?**

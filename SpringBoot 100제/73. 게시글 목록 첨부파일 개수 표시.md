### 73. 게시글 목록 조회 시 첨부파일 개수 표시

---

#### 1) **목표**

* 게시글 목록 조회 시 각 게시글에 첨부파일 개수 포함
* 기존 댓글 개수 표시(54단계)와 비슷한 방식 적용

---

#### 2) **DTO 추가**

**경로**: `src/main/java/com/example/springbootstart/dto/BoardWithFileCountDto.java`

```java
package com.example.springbootstart.dto;

import lombok.Getter;
import lombok.Setter;

@Getter
@Setter
public class BoardWithFileCountDto {
    private Long id;
    private Long userId;
    private String title;
    private String content;
    private String createdAt;
    private String updatedAt;
    private int fileCount; // 첨부파일 개수
}
```

---

#### 3) **Mapper 인터페이스**

**경로**: `src/main/java/com/example/springbootstart/mapper/BoardMapper.java`

```java
List<BoardWithFileCountDto> findBoardsWithFileCount();
```

---

#### 4) **Mapper XML**

**경로**: `src/main/resources/mapper/BoardMapper.xml`

```xml
<select id="findBoardsWithFileCount" resultType="com.example.springbootstart.dto.BoardWithFileCountDto">
    SELECT 
        b.id,
        b.user_id AS userId,
        b.title,
        b.content,
        b.created_at AS createdAt,
        b.updated_at AS updatedAt,
        (SELECT COUNT(*) FROM board_file bf WHERE bf.board_id = b.id) AS fileCount
    FROM board b
    ORDER BY b.id DESC
</select>
```

---

#### 5) **Service**

**경로**: `src/main/java/com/example/springbootstart/service/BoardService.java`

```java
import com.example.springbootstart.dto.BoardWithFileCountDto;

public List<BoardWithFileCountDto> getBoardsWithFileCount() {
    return boardMapper.findBoardsWithFileCount();
}
```

---

#### 6) **Controller**

**경로**: `src/main/java/com/example/springbootstart/controller/BoardController.java`

```java
@GetMapping("/with-file-count")
public ResponseEntity<?> getBoardsWithFileCount() {
    var boards = boardService.getBoardsWithFileCount();
    return ResponseEntity.ok(boards);
}
```

---

#### 7) **테스트**

**GET 요청**

```
GET /boards/with-file-count
```

**응답(JSON 예시)**

```json
[
  {
    "id": 5,
    "userId": 1,
    "title": "게시글 5",
    "content": "내용5",
    "createdAt": "2025-08-03T12:00:00",
    "updatedAt": "2025-08-03T12:00:00",
    "fileCount": 2
  },
  {
    "id": 4,
    "userId": 2,
    "title": "게시글 4",
    "content": "내용4",
    "createdAt": "2025-08-03T12:00:00",
    "updatedAt": "2025-08-03T12:00:00",
    "fileCount": 0
  }
]
```

---

### 결과

* 게시글 목록에서 첨부파일 개수 표시 가능
* UI에서 파일 아이콘과 함께 숫자 표시 용이

---

**다음 단계는 `74. 게시글 상세 조회 시 첨부파일 경로 포함` 입니다. 진행할까요?**

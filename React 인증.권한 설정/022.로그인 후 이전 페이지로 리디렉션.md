# 022. ë¡œê·¸ì¸ í›„ ì´ì „ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜

ì‚¬ìš©ìê°€ ì¸ì¦ì´ í•„ìš”í•œ í˜ì´ì§€ì— ì ‘ê·¼í–ˆì„ ë•Œ, ë¡œê·¸ì¸ í›„ ë‹¤ì‹œ ì›ë˜ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê²Œ í•˜ë ¤ë©´  
`React Router`ì˜ `location.state`ë¥¼ í™œìš©í•˜ì—¬ ë¦¬ë””ë ‰ì…˜ ê²½ë¡œë¥¼ ì €ì¥í•˜ê³ ,  
ë¡œê·¸ì¸ ì„±ê³µ ì‹œ í•´ë‹¹ ê²½ë¡œë¡œ ì´ë™ì‹œí‚µë‹ˆë‹¤.

---

## âœ… ì£¼ìš” í¬ì¸íŠ¸
- ì ‘ê·¼ ì‹œ locationì— `from` ê²½ë¡œ ì €ì¥
- ë¡œê·¸ì¸ ì„±ê³µ í›„ `navigate(from, { replace: true })` ì‚¬ìš©
- ê¸°ë³¸ ê²½ë¡œ(`/`) ì„¤ì •ë„ ê³ ë ¤

---

## âœ… ì˜ˆì‹œ ì½”ë“œ

### 1. ë³´í˜¸ ë¼ìš°íŠ¸ì—ì„œ ì´ì „ ê²½ë¡œ ì €ì¥ (src/routes/ProtectedRoute.js)

```jsx
import { Navigate, useLocation } from 'react-router-dom';
import useAuthStore from '../store/useAuthStore';

const ProtectedRoute = ({ children }) => {
  const { isAuthenticated } = useAuthStore();
  const location = useLocation();

  if (!isAuthenticated) {
    return <Navigate to="/login" state={{ from: location }} replace />;
  }

  return children;
};

export default ProtectedRoute;
```

---

### 2. ë¡œê·¸ì¸ í›„ ì´ì „ ê²½ë¡œë¡œ ì´ë™ (src/pages/Login.js)

```jsx
import { useLocation, useNavigate } from 'react-router-dom';
import useAuthStore from '../store/useAuthStore';
import { useState } from 'react';
import axios from 'axios';

const Login = () => {
  const { login } = useAuthStore();
  const navigate = useNavigate();
  const location = useLocation();
  const from = location.state?.from?.pathname || '/';

  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');

  const handleLogin = async () => {
    const res = await axios.post('/login', { email, password });
    login({ user: res.data.user, token: res.data.token });
    navigate(from, { replace: true }); // ì´ì „ ê²½ë¡œë¡œ ì´ë™
  };

  return (
    <div>
      <h2>ë¡œê·¸ì¸</h2>
      <input value={email} onChange={(e) => setEmail(e.target.value)} />
      <input type="password" value={password} onChange={(e) => setPassword(e.target.value)} />
      <button onClick={handleLogin}>ë¡œê·¸ì¸</button>
    </div>
  );
};

export default Login;
```

---

## ğŸ“ ì¶”ê°€ ì„¤ëª…
- ë¯¸ì¸ì¦ ì‚¬ìš©ìê°€ ì ‘ê·¼í•œ í˜ì´ì§€ë¥¼ ê¸°ì–µí•´ì„œ ë¡œê·¸ì¸ í›„ ê·¸ëŒ€ë¡œ ë¦¬í„´ë˜ë„ë¡ êµ¬í˜„
- `replace: true` ì˜µì…˜ì„ ë„£ìœ¼ë©´ ë¸Œë¼ìš°ì € íˆìŠ¤í† ë¦¬ì—ì„œ ì¤‘ë³µì„ ë°©ì§€
- ë°˜ë“œì‹œ location ê°ì²´ê°€ ìˆëŠ”ì§€ ì²´í¬í•œ í›„ ì‚¬ìš©í•´ì•¼ ì˜¤ë¥˜ ë°©ì§€ ê°€ëŠ¥

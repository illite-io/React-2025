좋습니다.
**71번 – 트랜잭션** 예제를 설명드리겠습니다.

---

## ✅ 71. 트랜잭션 (Transaction)

### 📌 개념

* 트랜잭션은 **하나 이상의 SQL 작업을 묶어서** 하나의 단위로 실행하는 기능
* 모든 작업이 **성공하면 COMMIT**, 하나라도 실패하면 **ROLLBACK**
* MySQL에서는 기본적으로 **InnoDB 스토리지 엔진**에서 트랜잭션 지원
* 4가지 성질: **ACID** (Atomicity, Consistency, Isolation, Durability)

---

### 📄 예제 1: 기본 트랜잭션 사용

```sql
START TRANSACTION;

UPDATE accounts SET balance = balance - 1000 WHERE id = 1;
UPDATE accounts SET balance = balance + 1000 WHERE id = 2;

COMMIT;
```

* 두 UPDATE가 모두 성공하면 COMMIT

---

### 📄 예제 2: 실패 시 ROLLBACK

```sql
START TRANSACTION;

UPDATE accounts SET balance = balance - 1000 WHERE id = 1;
-- 다음 쿼리에서 에러 발생
UPDATE accounts SET balance = balance + 1000 WHERE id = 999;

ROLLBACK;
```

* 두 번째 쿼리가 실패하므로 첫 번째 UPDATE도 취소

---

### 📄 예제 3: SAVEPOINT 사용

```sql
START TRANSACTION;

UPDATE accounts SET balance = balance - 500 WHERE id = 1;
SAVEPOINT step1;

UPDATE accounts SET balance = balance + 500 WHERE id = 2;
ROLLBACK TO step1;

COMMIT;
```

* 특정 시점(step1)까지 되돌릴 수 있음

---

### 📄 예제 4: 자동 커밋 비활성화

```sql
SET autocommit = 0;
```

* 모든 쿼리가 자동 COMMIT되지 않음 → 직접 COMMIT 필요

---

### 📄 예제 5: 트랜잭션 상태 확인

```sql
SHOW VARIABLES LIKE 'autocommit';
```

---

### 🧠 실무 팁

* 여러 UPDATE/INSERT/DELETE를 함께 처리해야 할 때 필수
* 트랜잭션이 너무 오래 지속되면 **잠금 경합(Lock Contention)** 발생 가능
* 꼭 필요한 범위에서만 사용하여 성능 저하 방지
* MyISAM은 트랜잭션을 지원하지 않으므로 주의

---

다음은 **72번 – LOCK** 예제로 넘어갑니다.
계속하시려면 `.` 을 입력해주세요.

좋습니다.
그럼 **React Hooks 시작하기 100제 – 45번 `useClipboard` (클립보드 복사/읽기)** 예제로 넘어가겠습니다.

---

## 45. `useClipboard` – 클립보드 복사/읽기

### 목적

* 텍스트를 클립보드에 **쓰기/읽기**하고, 상태(성공/실패/최근 값)를 관리
* `navigator.clipboard` 지원이 없는 환경에서 **폴백** 제공

---

### 파일 경로: `src/hooks/useClipboard.js`

```javascript
import { useCallback, useEffect, useRef, useState } from 'react';

/**
 * useClipboard
 * - write(text): 텍스트를 클립보드에 복사
 * - read(): 클립보드에서 텍스트 읽기 (권한 필요)
 * - state: { value, error, copied, canRead, canWrite }
 * - reset(): copied 플래그/에러 초기화
 *
 * 제약:
 * - 일부 브라우저/환경에선 HTTPS + 사용자 제스처(클릭) 필요
 * - read()는 권한(permission: 'clipboard-read')이 있어야 동작
 */
export default function useClipboard({ resetAfter = 1500 } = {}) {
  const [value, setValue] = useState('');    // 최근 복사/읽기 텍스트
  const [copied, setCopied] = useState(false);
  const [error, setError] = useState(null);
  const [canRead, setCanRead] = useState(false);
  const [canWrite, setCanWrite] = useState(false);
  const timerRef = useRef(null);

  // 권한/지원 여부 점검
  useEffect(() => {
    const secure = window.isSecureContext === true;
    const hasAPI = !!navigator.clipboard;

    setCanWrite(secure && hasAPI);

    // 권한 탐색(가능하면)
    const checkPermissions = async () => {
      try {
        if (!secure || !('permissions' in navigator)) return;
        const status = await navigator.permissions.query({ name: 'clipboard-read' });
        setCanRead(status.state === 'granted' || status.state === 'prompt');
      } catch {
        // permissions API 미지원
      }
    };
    checkPermissions();
  }, []);

  const reset = useCallback(() => {
    setCopied(false);
    setError(null);
  }, []);

  // 일정 시간 후 copied 플래그 초기화
  useEffect(() => {
    if (!copied || !resetAfter) return;
    timerRef.current && clearTimeout(timerRef.current);
    timerRef.current = setTimeout(() => setCopied(false), resetAfter);
    return () => timerRef.current && clearTimeout(timerRef.current);
  }, [copied, resetAfter]);

  // 폴백: execCommand('copy')
  const legacyCopy = useCallback((text) => {
    try {
      const textarea = document.createElement('textarea');
      textarea.value = text;
      textarea.style.position = 'fixed';
      textarea.style.opacity = '0';
      document.body.appendChild(textarea);
      textarea.focus();
      textarea.select();
      const ok = document.execCommand('copy');
      document.body.removeChild(textarea);
      if (!ok) throw new Error('execCommand copy 실패');
      return true;
    } catch (err) {
      setError(err);
      return false;
    }
  }, []);

  // 쓰기
  const write = useCallback(async (text) => {
    setError(null);
    try {
      if (navigator.clipboard && window.isSecureContext) {
        await navigator.clipboard.writeText(text);
        setValue(text);
        setCopied(true);
        return true;
      }
      // 비보안 컨텍스트 or API 미지원 → 폴백
      const ok = legacyCopy(text);
      if (ok) {
        setValue(text);
        setCopied(true);
      }
      return ok;
    } catch (err) {
      setError(err);
      return false;
    }
  }, [legacyCopy]);

  // 읽기
  const read = useCallback(async () => {
    setError(null);
    try {
      if (!navigator.clipboard || !window.isSecureContext) {
        throw new Error('클립보드 읽기 미지원(보안 컨텍스트/브라우저 제한)');
      }
      const text = await navigator.clipboard.readText();
      setValue(text);
      return text;
    } catch (err) {
      setError(err);
      return null;
    }
  }, []);

  return {
    value,
    copied,
    error,
    canRead,
    canWrite,
    write,
    read,
    reset,
  };
}
```

---

### 사용 예시

**파일 경로:** `src/App.js`

```javascript
import React, { useState } from 'react';
import useClipboard from './hooks/useClipboard';

export default function App() {
  const [input, setInput] = useState('복사할 텍스트 예시');
  const { value, copied, error, canRead, canWrite, write, read, reset } = useClipboard();

  const copyNow = async () => {
    await write(input);
  };

  const readNow = async () => {
    const text = await read();
    if (text !== null) {
      alert('클립보드에서 읽음: ' + text);
    }
  };

  return (
    <div style={{ padding: 24, maxWidth: 560 }}>
      <h1>useClipboard – 클립보드 복사/읽기</h1>

      <label htmlFor="text">텍스트</label>
      <input
        id="text"
        type="text"
        value={input}
        onChange={(e) => setInput(e.target.value)}
        style={{ display: 'block', width: '100%', marginBottom: 12 }}
      />

      <div style={{ display: 'flex', gap: 8 }}>
        <button onClick={copyNow}>클립보드로 복사</button>
        <button onClick={readNow} disabled={!canRead}>클립보드에서 읽기</button>
        <button onClick={reset}>상태 초기화</button>
      </div>

      <div style={{ marginTop: 16 }}>
        <p>최근 값(value): {value ? <code>{value}</code> : '없음'}</p>
        <p>복사됨(copied): {copied ? '예' : '아니오'}</p>
        <p>쓰기 가능(canWrite): {canWrite ? '예' : '아니오'}</p>
        <p>읽기 가능(canRead): {canRead ? '예' : '아니오'}</p>
        {error && (
          <p style={{ color: 'crimson' }}>
            에러: {String(error.message || error)}
          </p>
        )}
      </div>

      <small style={{ color: '#6b7280' }}>
        참고: 일부 브라우저/환경에서는 HTTPS 및 사용자 제스처(버튼 클릭) 없이 클립보드 접근이 제한될 수 있습니다.
      </small>
    </div>
  );
}
```

---

### 핵심 포인트

* **보안 컨텍스트(HTTPS)** + **사용자 제스처**가 있어야 신형 Clipboard API가 신뢰성 있게 동작
* 읽기(`readText`)는 권한이 더 엄격하므로 실패 대비 안내 필요
* 쓰기 실패 시 `execCommand('copy')` 폴백을 시도해 실사용성을 높임
* 훅이 `value/copied/error/canRead/canWrite`를 제공해 UI에서 즉시 반영 가능

---

다음은 **46번 `useTransition` – 대규모 리스트 렌더링 최적화 실전**으로 이어가겠습니다. 계속 진행할까요?

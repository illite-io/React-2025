좋습니다.
그럼 **React Hooks 시작하기 100제 – 33번 `useForm` (폼 상태 관리)** 예제로 넘어가겠습니다.

---

## 33. `useForm` – 폼 상태 관리

### 목적

* 입력값, 에러, 제출 처리 등을 커스텀 훅으로 캡슐화
* `value`, `onChange`, 유효성 검증을 일관된 방식으로 재사용

---

### 파일 경로: `src/hooks/useForm.js`

```javascript
import { useCallback, useMemo, useState } from 'react';

/**
 * 간단한 폼 훅
 * - values: 입력값 상태
 * - errors: 검증 에러 메시지
 * - register: input에 바인딩할 props 반환
 * - handleSubmit: 제출 핸들러 (검증 통과 시 onValid 호출)
 * - reset: 값/에러 초기화
 *
 * 사용 예:
 * const { values, errors, register, handleSubmit, reset } = useForm({
 *   initialValues: { email: '', password: '' },
 *   validators: {
 *     email: [(v) => (!v ? '이메일을 입력하세요' : null),
 *             (v) => (!/.+@.+/.test(v) ? '이메일 형식이 아닙니다' : null)],
 *     password: [(v) => (v.length < 6 ? '6자 이상 입력' : null)]
 *   }
 * });
 */
export default function useForm({ initialValues = {}, validators = {} } = {}) {
  const [values, setValues] = useState(initialValues);
  const [errors, setErrors] = useState({}); // { field: '에러 메시지' }

  const validateField = useCallback((name, value) => {
    const rules = validators[name] || [];
    for (const rule of rules) {
      const msg = rule(value, values);
      if (msg) return msg; // 첫 에러만 반환
    }
    return null;
  }, [validators, values]);

  const validateAll = useCallback((nextValues = values) => {
    const nextErrors = {};
    for (const name of Object.keys(nextValues)) {
      const msg = validateField(name, nextValues[name]);
      if (msg) nextErrors[name] = msg;
    }
    return nextErrors;
  }, [validateField, values]);

  const setValue = useCallback((name, value) => {
    setValues((prev) => {
      const next = { ...prev, [name]: value };
      // 변경된 필드 즉시 검증
      const msg = validateField(name, value);
      setErrors((prevErr) => {
        const e = { ...prevErr };
        if (msg) e[name] = msg;
        else delete e[name];
        return e;
      });
      return next;
    });
  }, [validateField]);

  const register = useCallback((name, options = {}) => {
    const { parse = (v) => v } = options;
    return {
      name,
      value: values[name] ?? '',
      onChange: (e) => {
        const raw = e?.target ? e.target.value : e;
        setValue(name, parse(raw));
      },
      onBlur: () => {
        // 블러 시 전체 규칙 재검증(선택)
        const msg = validateField(name, values[name]);
        setErrors((prev) => (msg ? { ...prev, [name]: msg } : (() => {
          const next = { ...prev };
          delete next[name];
          return next;
        })()));
      }
    };
  }, [values, setValue, validateField]);

  const handleSubmit = useCallback((onValid, onInvalid) => {
    return (e) => {
      if (e && typeof e.preventDefault === 'function') e.preventDefault();
      const nextErrors = validateAll();
      if (Object.keys(nextErrors).length === 0) {
        onValid(values);
      } else {
        setErrors(nextErrors);
        onInvalid && onInvalid(nextErrors);
      }
    };
  }, [validateAll, values]);

  const reset = useCallback((next = initialValues) => {
    setValues(next);
    setErrors({});
  }, [initialValues]);

  // 유틸
  const isValid = useMemo(() => Object.keys(errors).length === 0, [errors]);

  return { values, errors, isValid, register, setValue, handleSubmit, reset };
}
```

---

### 사용 예시

**파일 경로:** `src/App.js`

```javascript
import React from 'react';
import useForm from './hooks/useForm';

export default function App() {
  const { values, errors, isValid, register, handleSubmit, reset } = useForm({
    initialValues: {
      email: '',
      password: '',
      confirm: '',
      nickname: ''
    },
    validators: {
      email: [
        (v) => (!v ? '이메일을 입력하세요' : null),
        (v) => (!/.+@.+\..+/.test(v) ? '이메일 형식이 아닙니다' : null),
      ],
      password: [
        (v) => (!v ? '비밀번호를 입력하세요' : null),
        (v) => (v.length < 6 ? '6자 이상 입력하세요' : null),
        (v) => (!/[0-9]/.test(v) ? '숫자를 포함하세요' : null),
      ],
      confirm: [
        (v, all) => (v !== all.password ? '비밀번호가 일치하지 않습니다' : null),
      ],
      nickname: [
        (v) => (!v ? '닉네임을 입력하세요' : null),
        (v) => (!/^[A-Za-z0-9_]{3,12}$/.test(v) ? '영문/숫자/_ 3~12자' : null),
      ],
    },
  });

  const onValid = (data) => {
    alert('제출 성공:\n' + JSON.stringify(data, null, 2));
    // 실제 앱에서는 API 요청 수행
  };
  const onInvalid = (errs) => {
    console.warn('검증 실패:', errs);
  };

  return (
    <div style={{ padding: 24, maxWidth: 420 }}>
      <h1>useForm – 폼 상태 관리</h1>

      <label htmlFor="email">이메일</label>
      <input id="email" type="email" {...register('email')} />
      {errors.email && <p style={{ color: 'crimson' }}>{errors.email}</p>}

      <label htmlFor="password" style={{ marginTop: 12, display: 'block' }}>
        비밀번호
      </label>
      <input id="password" type="password" {...register('password')} />
      {errors.password && <p style={{ color: 'crimson' }}>{errors.password}</p>}

      <label htmlFor="confirm" style={{ marginTop: 12, display: 'block' }}>
        비밀번호 확인
      </label>
      <input id="confirm" type="password" {...register('confirm')} />
      {errors.confirm && <p style={{ color: 'crimson' }}>{errors.confirm}</p>}

      <label htmlFor="nickname" style={{ marginTop: 12, display: 'block' }}>
        닉네임
      </label>
      <input id="nickname" type="text" placeholder="3~12자" {...register('nickname')} />
      {errors.nickname && <p style={{ color: 'crimson' }}>{errors.nickname}</p>}

      <div style={{ marginTop: 16, display: 'flex', gap: 8 }}>
        <button onClick={handleSubmit(onValid, onInvalid)} disabled={!isValid}>
          제출
        </button>
        <button type="button" onClick={() => reset()}>
          초기화
        </button>
      </div>

      <pre style={{ marginTop: 16, background: '#f7f7f7', padding: 12, borderRadius: 8 }}>
{JSON.stringify({ values, errors, isValid }, null, 2)}
      </pre>
    </div>
  );
}
```

---

### 핵심 포인트

* `register(name)`가 반환한 props를 input에 그대로 펼치면(`{...register('email')}`) 값/이벤트가 자동 연결
* `validators`는 필드별 배열로 구성, 첫 에러 메시지만 표시하는 단순 전략
* 제출 시 `validateAll()`로 전체 검증을 실행하고, 통과하면 `onValid(values)` 호출
* 값 재설정이 필요하면 `reset(nextValues)` 사용

---

다음은 **34번 `useLocalStorage` – 로컬 스토리지 상태 저장** 예제로 이어가겠습니다.
계속 진행할까요?

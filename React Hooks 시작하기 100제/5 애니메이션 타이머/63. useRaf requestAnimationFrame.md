좋습니다.
**React Hooks 시작하기 100제 – 63번 `useMultiKeyPress` (여러 키 조합 감지)** 예제로 넘어가겠습니다.

---

## 63. `useMultiKeyPress` – 여러 키 조합 감지

### 목적

* 동시에 누른 키들의 집합을 추적하고, **조합 단축키**를 인식
* 예: `Ctrl+K`로 커맨드 팔레트 열기, `Shift+?`로 도움말 표시 등

---

### 파일 경로: `src/hooks/useMultiKeyPress.js`

```javascript
import { useEffect, useMemo, useRef, useState } from 'react';

/**
 * 키 이름 정규화 유틸
 * - 대소문자 통일, Meta/Control/Shift/Alt 등 표준화
 */
function normKey(k) {
  if (!k) return '';
  const m = k.toLowerCase();
  // 브라우저별 스페셜 키 호환 처리
  if (m === 'esc') return 'escape';
  if (m === ' ') return 'space';
  if (m === 'arrowleft' || m === 'left') return 'arrowleft';
  if (m === 'arrowright' || m === 'right') return 'arrowright';
  if (m === 'arrowup' || m === 'up') return 'arrowup';
  if (m === 'arrowdown' || m === 'down') return 'arrowdown';
  // 보조키는 소문자 통일
  if (['meta', 'control', 'ctrl', 'shift', 'alt'].includes(m)) {
    if (m === 'ctrl') return 'control';
    return m;
  }
  return m;
}

/**
 * useMultiKeyPress
 * @param {object} options
 * @param {Array<string[]>} [options.combos] - 트리거할 조합 목록. 예: [['control','k'], ['meta','k']]
 * @param {(combo: string[]) => void} [options.onMatch] - 조합이 성립됐을 때 호출
 * @param {boolean} [options.preventDefault=false] - 일치 시 브라우저 기본 동작 방지
 *
 * @returns {{
 *   pressed: Set<string>,          // 현재 눌린 키들의 집합(정규화된 키명)
 *   isPressed: (key:string)=>bool, // 특정 키 눌림 여부
 *   isComboPressed: (combo:string[])=>bool // 조합 성립 여부
 * }}
 */
export default function useMultiKeyPress({
  combos = [],
  onMatch,
  preventDefault = false,
} = {}) {
  const [pressed, setPressed] = useState(() => new Set());
  const pressedRef = useRef(pressed);
  pressedRef.current = pressed;

  const sortedCombos = useMemo(
    () => combos.map(c => c.map(normKey).sort()),
    [combos]
  );

  const isPressed = (key) => pressedRef.current.has(normKey(key));

  const isComboPressed = (combo) => {
    const target = combo.map(normKey);
    return target.every(k => pressedRef.current.has(k));
  };

  useEffect(() => {
    const down = (e) => {
      const k = normKey(e.key);
      // 보조키는 e.ctrlKey/e.metaKey 등으로도 들어오므로, key 셋에 반영
      const next = new Set(pressedRef.current);
      next.add(k);
      if (e.ctrlKey) next.add('control');
      if (e.metaKey) next.add('meta');
      if (e.shiftKey) next.add('shift');
      if (e.altKey) next.add('alt');

      // 상태 업데이트가 연속 키 입력에 뒤처지지 않도록 즉시 Set 교체
      setPressed(next);

      // 매칭 검사
      for (const combo of sortedCombos) {
        const ok = combo.every(key => next.has(key));
        if (ok) {
          if (preventDefault) e.preventDefault();
          onMatch && onMatch(combo);
          break;
        }
      }
    };

    const up = (e) => {
      const k = normKey(e.key);
      const next = new Set(pressedRef.current);
      next.delete(k);
      // 보조키는 키업에서 플래그 해제
      if (!e.ctrlKey) next.delete('control');
      if (!e.metaKey) next.delete('meta');
      if (!e.shiftKey) next.delete('shift');
      if (!e.altKey) next.delete('alt');
      setPressed(next);
    };

    const blur = () => {
      // 창 전환 등으로 stuck 상태 방지
      setPressed(new Set());
    };

    window.addEventListener('keydown', down);
    window.addEventListener('keyup', up);
    window.addEventListener('blur', blur);
    return () => {
      window.removeEventListener('keydown', down);
      window.removeEventListener('keyup', up);
      window.removeEventListener('blur', blur);
    };
  }, [sortedCombos, onMatch, preventDefault]);

  return {
    pressed,
    isPressed,
    isComboPressed,
  };
}
```

---

### 사용 예시 – 커맨드 팔레트(`Ctrl+K` 또는 `Meta+K`)

**파일 경로:** `src/App.js`

```javascript
import React, { useState } from 'react';
import useMultiKeyPress from './hooks/useMultiKeyPress';

export default function App() {
  const [open, setOpen] = useState(false);

  useMultiKeyPress({
    combos: [
      ['control', 'k'], // Windows/Linux
      ['meta', 'k'],    // macOS Command+K
    ],
    preventDefault: true,
    onMatch: () => setOpen((v) => !v),
  });

  return (
    <div style={{ padding: 24 }}>
      <h1>useMultiKeyPress – 여러 키 조합 감지</h1>
      <p>Ctrl+K (또는 macOS에서 ⌘+K)를 눌러 커맨드 팔레트를 토글하세요.</p>

      {open && (
        <div
          role="dialog"
          aria-modal="true"
          style={{
            marginTop: 12,
            padding: 16,
            borderRadius: 12,
            border: '1px solid #e5e7eb',
            boxShadow: '0 12px 28px rgba(0,0,0,0.15)',
            background: '#fff',
            maxWidth: 520,
          }}
        >
          <strong>커맨드 팔레트</strong>
          <p style={{ color: '#64748b' }}>여기에 검색 입력/명령 목록을 구성하세요.</p>
        </div>
      )}
    </div>
  );
}
```

---

### 팁

* 키 이름은 **정규화(normKey)** 되어 관리되므로 `Ctrl`/`ctrl`/`Control` 혼용을 신경쓰지 않아도 됩니다.
* 브라우저 단축키와 충돌할 수 있는 조합은 `preventDefault: true`로 기본 동작을 막을 수 있습니다.
* 조합 종류를 늘리고 싶다면 `combos`에 배열을 추가하면 됩니다. 예: `['shift','?']`, `['alt','enter']`.
* 현재 눌린 키 집합(`pressed`)을 직접 활용해 **상태 기반** UI도 가능하며, `isComboPressed(['shift','arrowup'])`로 실시간 체크도 할 수 있습니다.

---

다음은 **64번 `useDebounce` – 디바운스 값/함수** 예제로 이어가겠습니다. 계속 진행하겠습니다.

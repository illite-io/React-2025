좋습니다.
그럼 **React Hooks 시작하기 100제 – 96번 `useGeolocation` (사용자 위치 추적)** 예제로 넘어가겠습니다.

---

## 96. `useGeolocation` – 사용자 위치 추적

### 목적

* 브라우저 Geolocation API로 **현재 위치**를 가져오고(once) 또는 **연속 추적**(watch)
* 지도 초기 중심점, 근처 매장 검색, 이동 경로 기록 등에 활용

---

### 파일 경로: `src/hooks/useGeolocation.js`

```javascript
import { useCallback, useEffect, useRef, useState } from 'react';

/**
 * useGeolocation
 * @param {Object} [options]
 * @param {boolean} [options.enableHighAccuracy=false]
 * @param {number}  [options.timeout=10000]
 * @param {number}  [options.maximumAge=0]
 * @param {boolean} [options.watch=false]  // true면 지속 추적
 *
 * @returns {{
 *   coords: { latitude:number, longitude:number, accuracy?:number, altitude?:number|null, heading?:number|null, speed?:number|null } | null,
 *   timestamp: number | null,
 *   error: string | null,
 *   start: () => void,
 *   stop: () => void
 * }}
 */
export default function useGeolocation({
  enableHighAccuracy = false,
  timeout = 10000,
  maximumAge = 0,
  watch = false,
} = {}) {
  const [coords, setCoords] = useState(null);
  const [timestamp, setTimestamp] = useState(null);
  const [error, setError] = useState(null);
  const watchIdRef = useRef(null);

  const onSuccess = useCallback((pos) => {
    const { latitude, longitude, accuracy, altitude, heading, speed } = pos.coords || {};
    setCoords({ latitude, longitude, accuracy, altitude, heading, speed });
    setTimestamp(pos.timestamp || Date.now());
    setError(null);
  }, []);

  const onError = useCallback((err) => {
    setError(err?.message || '위치 정보를 가져오지 못했습니다.');
  }, []);

  const start = useCallback(() => {
    if (!('geolocation' in navigator)) {
      setError('이 브라우저는 Geolocation을 지원하지 않습니다.');
      return;
    }
    const opts = { enableHighAccuracy, timeout, maximumAge };
    if (watch) {
      if (watchIdRef.current != null) return; // 이미 감시 중
      watchIdRef.current = navigator.geolocation.watchPosition(onSuccess, onError, opts);
    } else {
      navigator.geolocation.getCurrentPosition(onSuccess, onError, opts);
    }
  }, [enableHighAccuracy, timeout, maximumAge, watch, onSuccess, onError]);

  const stop = useCallback(() => {
    if (watchIdRef.current != null && navigator.geolocation.clearWatch) {
      navigator.geolocation.clearWatch(watchIdRef.current);
      watchIdRef.current = null;
    }
  }, []);

  // watch 모드일 때 자동 시작/정리
  useEffect(() => {
    if (watch) start();
    return () => stop();
  }, [watch, start, stop]);

  return { coords, timestamp, error, start, stop };
}
```

---

### 사용 예시

**파일 경로:** `src/App.js`

```javascript
import React from 'react';
import useGeolocation from './hooks/useGeolocation';

export default function App() {
  const { coords, timestamp, error, start, stop } = useGeolocation({
    enableHighAccuracy: true,
    timeout: 15000,
    maximumAge: 5000,
    watch: false, // 필요 시 true로 바꿔 지속 추적
  });

  return (
    <div style={{ padding: 24 }}>
      <h1>useGeolocation – 위치 추적</h1>

      <div style={{ display: 'flex', gap: 8, marginBottom: 12 }}>
        <button onClick={start}>현재 위치 가져오기</button>
        <button onClick={stop}>추적 중지</button>
      </div>

      {error && <p style={{ color: 'crimson' }}>오류: {error}</p>}
      {coords ? (
        <div>
          <p>위도: {coords.latitude}</p>
          <p>경도: {coords.longitude}</p>
          {coords.accuracy != null && <p>정확도: ±{Math.round(coords.accuracy)}m</p>}
          <p>갱신 시각: {new Date(timestamp).toLocaleTimeString()}</p>
        </div>
      ) : (
        <p>위치 정보가 없습니다. 버튼을 눌러 요청하세요.</p>
      )}
    </div>
  );
}
```

---

### 구현 포인트

* HTTPS 환경 또는 localhost에서만 동작하며, **사용자 허용**이 필요
* `enableHighAccuracy`는 배터리 사용량 증가 가능
* 단발성(`getCurrentPosition`)과 지속 추적(`watchPosition`)을 옵션으로 분기
* 언마운트 시 `clearWatch`로 정리
* 에러 케이스: 권한 거부, 시간 초과, 위치 서비스 비활성화 등 처리 필수

---

다음은 **97번 `useBattery` – 배터리 상태 감지** 또는 **98번 `useNetworkStatus` – 온라인/오프라인 및 대역폭 추정** 중 어떤 것으로 이어갈까요?
